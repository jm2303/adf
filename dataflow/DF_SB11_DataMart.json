{
	"name": "DF_SB11_DataMart",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "DS_OPENICFES_STAGING_PARQUET",
						"type": "DatasetReference"
					},
					"name": "SB11PARQUET"
				}
			],
			"sinks": [
				{
					"name": "AzureSQL"
				}
			],
			"transformations": [
				{
					"name": "SelectColumnas"
				}
			],
			"scriptLines": [
				"source(output(",
				"          ESTU_TIPODOCUMENTO as string,",
				"          ESTU_NACIONALIDAD as string,",
				"          ESTU_GENERO as string,",
				"          ESTU_FECHANACIMIENTO as string,",
				"          PERIODO as integer,",
				"          ESTU_CONSECUTIVO as string,",
				"          ESTU_ESTUDIANTE as string,",
				"          ESTU_PAIS_RESIDE as string,",
				"          ESTU_TIENEETNIA as string,",
				"          ESTU_DEPTO_RESIDE as string,",
				"          ESTU_COD_RESIDE_DEPTO as string,",
				"          ESTU_MCPIO_RESIDE as string,",
				"          ESTU_COD_RESIDE_MCPIO as string,",
				"          FAMI_EDUCACIONPADRE as string,",
				"          FAMI_EDUCACIONMADRE as string,",
				"          FAMI_ESTRATOVIVIENDA as string,",
				"          FAMI_PERSONASHOGAR as string,",
				"          FAMI_CUARTOSHOGAR as string,",
				"          FAMI_TIENEINTERNET as string,",
				"          FAMI_TIENECOMPUTADOR as string,",
				"          FAMI_TIENELAVADORA as string,",
				"          FAMI_TIENEHORNOMICROOGAS as string,",
				"          FAMI_TIENESERVICIOTV as string,",
				"          FAMI_TIENEAUTOMOVIL as string,",
				"          FAMI_TIENEMOTOCICLETA as string,",
				"          FAMI_TIENECONSOLAVIDEOJUEGOS as string,",
				"          FAMI_NUMLIBROS as string,",
				"          ESTU_DEDICACIONLECTURADIARIA as string,",
				"          ESTU_DEDICACIONINTERNET as string,",
				"          ESTU_HORASSEMANATRABAJA as string,",
				"          ESTU_TIPOREMUNERACION as string,",
				"          FAMI_COMELECHEDERIVADOS as string,",
				"          FAMI_COMECARNEPESCADOHUEVO as string,",
				"          FAMI_COMECEREALFRUTOSLEGUMBRE as string,",
				"          FAMI_TRABAJOLABORPADRE as string,",
				"          FAMI_TRABAJOLABORMADRE as string,",
				"          FAMI_SITUACIONECONOMICA as string,",
				"          COLE_COD_DANE_ESTABLECIMIENTO as string,",
				"          COLE_CODIGO_ICFES as string,",
				"          COLE_NOMBRE_ESTABLECIMIENTO as string,",
				"          COLE_JORNADA as string,",
				"          COLE_GENERO as string,",
				"          COLE_NATURALEZA as string,",
				"          COLE_CALENDARIO as string,",
				"          COLE_BILINGUE as string,",
				"          COLE_CARACTER as string,",
				"          COLE_COD_DANE_SEDE as string,",
				"          COLE_NOMBRE_SEDE as string,",
				"          COLE_SEDE_PRINCIPAL as string,",
				"          COLE_AREA_UBICACION as string,",
				"          COLE_COD_MCPIO_UBICACION as string,",
				"          COLE_MCPIO_UBICACION as string,",
				"          COLE_COD_DEPTO_UBICACION as string,",
				"          COLE_DEPTO_UBICACION as string,",
				"          ESTU_PRIVADO_LIBERTAD as string,",
				"          ESTU_COD_MCPIO_PRESENTACION as string,",
				"          ESTU_MCPIO_PRESENTACION as string,",
				"          ESTU_DEPTO_PRESENTACION as string,",
				"          ESTU_COD_DEPTO_PRESENTACION as string,",
				"          PUNT_MATEMATICAS as integer,",
				"          DESEMP_MATEMATICAS as integer,",
				"          PERCENTIL_MATEMATICAS as integer,",
				"          PUNT_INGLES as integer,",
				"          PERCENTIL_INGLES as integer,",
				"          DESEMP_INGLES as string,",
				"          PUNT_C_NATURALES as integer,",
				"          DESEMP_C_NATURALES as string,",
				"          PERCENTIL_C_NATURALES as integer,",
				"          PUNT_LECTURA_CRITICA as integer,",
				"          DESEMP_LECTURA_CRITICA as integer,",
				"          PERCENTIL_LECTURA_CRITICA as integer,",
				"          PUNT_SOCIALES_CIUDADANAS as integer,",
				"          DESEMP_SOCIALES_CIUDADANAS as integer,",
				"          PERCENTIL_SOCIALES_CIUDADANAS as integer,",
				"          PUNT_GLOBAL as integer,",
				"          PERCENTIL_GLOBAL as integer,",
				"          PERCENTIL_ESPECIAL_GLOBAL as integer,",
				"          year as string,",
				"          semester as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     format: 'parquet') ~> SB11PARQUET",
				"SB11PARQUET select(mapColumn(",
				"          ESTU_GENERO,",
				"          ESTU_FECHANACIMIENTO,",
				"          PERIODO,",
				"          ESTU_CONSECUTIVO,",
				"          FAMI_ESTRATOVIVIENDA,",
				"          FAMI_TIENEINTERNET,",
				"          ESTU_HORASSEMANATRABAJA,",
				"          COLE_CODIGO_ICFES,",
				"          COLE_GENERO,",
				"          COLE_NATURALEZA,",
				"          COLE_CALENDARIO,",
				"          COLE_BILINGUE,",
				"          COLE_CARACTER,",
				"          COLE_COD_MCPIO_UBICACION,",
				"          PUNT_MATEMATICAS,",
				"          DESEMP_MATEMATICAS,",
				"          PERCENTIL_MATEMATICAS,",
				"          PUNT_INGLES,",
				"          PERCENTIL_INGLES,",
				"          DESEMP_INGLES,",
				"          PUNT_C_NATURALES,",
				"          DESEMP_C_NATURALES,",
				"          PERCENTIL_C_NATURALES,",
				"          PUNT_LECTURA_CRITICA,",
				"          DESEMP_LECTURA_CRITICA,",
				"          PERCENTIL_LECTURA_CRITICA,",
				"          PUNT_SOCIALES_CIUDADANAS,",
				"          DESEMP_SOCIALES_CIUDADANAS,",
				"          PERCENTIL_SOCIALES_CIUDADANAS,",
				"          PUNT_GLOBAL,",
				"          PERCENTIL_GLOBAL,",
				"          PERCENTIL_ESPECIAL_GLOBAL,",
				"          year,",
				"          semester",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectColumnas",
				"SelectColumnas sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     saveOrder: 1) ~> AzureSQL"
			]
		}
	}
}